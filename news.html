<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" href="https://i.imgur.com/WPy5YDY.png">
    <title>News | Literary Speaking</title>
    <link rel="stylesheet" href="style.css">
    <style>
        .hero-banner{height:60vh;min-height:400px;display:flex;align-items:center;justify-content:center;color:#fff;text-align:center;position:relative;padding:0 20px;background-image:url(https://i.imgur.com/p6BgTSq.png);background-attachment:fixed;background-position:center;background-repeat:no-repeat;background-size:cover}
        .hero-banner .overlay{position:absolute;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,.5);z-index:2}
        .hero-banner .content{position:relative;z-index:3}
        .hero-banner h1{font-size:3.8rem;font-weight:900;margin:0;line-height:1.2}
        
        .news-grid {display:grid;grid-template-columns:repeat(auto-fit, minmax(320px, 1fr));gap:30px; margin-top: 40px;}
        .news-card {background-color:#fff;border-radius:16px;overflow:hidden;box-shadow:0 8px 24px rgba(0,0,0,0.08);transition:transform .3s ease, box-shadow .3s ease;display:flex;flex-direction:column;text-align:left;cursor:pointer;}
        .news-card:hover {transform:translateY(-8px);box-shadow:0 12px 32px rgba(0,0,0,0.12);}
        .news-card-image-wrapper {position:relative;width:100%;aspect-ratio:16/9;}
        .news-card-image {width:100%;height:100%;object-fit:cover;}
        .news-card-content {padding:25px;flex-grow:1;display:flex;flex-direction:column;}
        .news-card-meta {font-size:0.9rem;color:var(--color-text-light);margin-bottom:15px;}
        .news-card-title {font-size:1.4rem;font-weight:700;margin:0 0 15px;line-height:1.3;color:var(--color-text);}
        .news-card-excerpt {font-size:1rem;line-height:1.6;color:var(--color-text-light);flex-grow:1;}
        .read-more-link {color:var(--color-purple-dark);text-decoration:none;font-weight:700;display:flex;align-items:center;gap:8px; margin-top: 20px;}
        .read-more-link:hover {text-decoration:underline;}

        .social-section{background-color:var(--color-pink); padding: 80px 0;}
        .social-box{background-color:#fff0f5;padding:50px;border-radius:16px;box-shadow:0 15px 30px rgba(0,0,0,0.1);color:var(--color-purple-dark)}
        .social-box .section-title, .social-box .section-subtitle{color:var(--color-purple-dark)}
        .social-box .section-subtitle a{color:var(--color-purple-dark);font-weight:700}
        
        @media (max-width:768px){
        .hero-banner{background-attachment:scroll}
        .hero-banner h1{font-size:2.2rem}
        .social-box{padding:30px}
        }
    </style>
</head>
<body data-current-page="news">
    <header class="site-header" id="header"></header>

    <main>
        <section class="hero-banner">
            <div class="overlay"></div>
            <div class="content scroll-animated">
                <h1 class="lang-switch" data-en="News" data-es="Noticias"></h1>
            </div>
        </section>

        <section class="section" style="background-color: #ffffff;">
            <div class="container">
                <div id="news-grid-container" class="news-grid"></div>
            </div>
        </section>

        <section class="section social-section">
            <div class="container scroll-animated">
                <div class="social-box">
                    <h2 class="section-title lang-switch" data-en="Social Media" data-es="Redes Sociales"></h2>
                    <p class="section-subtitle">Follow us <a href="https://www.instagram.com/literaryspeakingtutoring/" target="_blank" rel="noopener noreferrer">@literaryspeakingtutoring</a></p>
                    <div id="curator-feed-default-feed-layout"><a href="https://curator.io/" target="_blank" class="crt-logo crt-tag">Powered by Curator.io</a></div>
                </div>
            </div>
        </section>
    </main>

    <footer class="site-footer"></footer>

    <script src="router.js"></script>
    <script type="text/javascript">
    (function(){
    var i,e,d=document,s="script";i=d.createElement("script");i.async=1;i.charset="UTF-8";
    i.src="https://cdn.curator.io/published/ecfc6731-dd7d-4877-bdc8-6e38d9fc2813.js";
    e=d.getElementsByTagName(s)[0];e.parentNode.insertBefore(i, e);
    })();
    </script>
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-app.js";
        import { getFirestore, collection, getDocs, query, orderBy } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyD0qVihpuLI0cF0PZ32o8tFBLfTgjlqB6A",
            authDomain: "literary-speaking.firebaseapp.com",
            projectId: "literary-speaking",
            storageBucket: "literary-speaking.appspot.com",
            messagingSenderId: "699059463612",
            appId: "1:699059463612:web:ecb2e784d627c6b93937b9",
            measurementId: "G-0L1V3XXGGR"
        };
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        document.addEventListener('DOMContentLoaded', async () => {
            const newsQuery = query(collection(db, "news"), orderBy("date", "desc"));
            const querySnapshot = await getDocs(newsQuery);
            const newsItems = querySnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
            const gridContainer = document.getElementById('news-grid-container');

            const populateGrid = (lang) => {
                if (!gridContainer) return;
                gridContainer.innerHTML = '';

                if (newsItems.length === 0) {
                    gridContainer.innerHTML = `<p class="lang-switch" data-en="No news items yet. Check back soon!" data-es="Aún no hay noticias. ¡Vuelve pronto!"></p>`;
                    siteRouter.applyLanguage(lang);
                    return;
                }

                newsItems.forEach(item => {
                    const itemDate = new Date(item.date).toLocaleDateString(lang.startsWith('es') ? 'es-ES' : 'en-US', { year: 'numeric', month: 'long', day: 'numeric' });
                    const card = document.createElement('div');
                    card.className = 'news-card';
                    card.addEventListener('click', () => siteRouter.navigateTo('news-single', item.id));
                    card.innerHTML = `
                        <div class="news-card-image-wrapper"><img src="${item.image}" alt="" class="news-card-image"></div>
                        <div class="news-card-content">
                            <p class="news-card-meta">${itemDate}</p>
                            <h3 class="news-card-title">${item[`title_${lang}`]}</h3>
                            <p class="news-card-excerpt">${item[`excerpt_${lang}`]}</p>
                            <span class="read-more-link">${lang === 'es' ? 'Leer Más' : 'Read More'}</span>
                        </div>
                    `;
                    gridContainer.appendChild(card);
                });
            };
            
            const initialLang = localStorage.getItem('language') || 'en';
            populateGrid(initialLang);

            const langObserver = new MutationObserver(() => {
                populateGrid(document.documentElement.lang);
            });
            langObserver.observe(document.documentElement, { attributes: true, attributeFilter: ['lang'] });

            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('is-visible');
                        observer.unobserve(entry.target);
                    }
                });
            }, { threshold: 0.1 });

            document.querySelectorAll('main .scroll-animated').forEach(el => {
                observer.observe(el);
            });
        });
    </script>
</body>
</html>
